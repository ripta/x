import*as e from"three";import{FontLoader as t}from"three/addons/loaders/FontLoader.js";import{TextGeometry as n}from"three/addons/geometries/TextGeometry.js";var a;var o;var r;var i="Merry Christmas ~ From Ripta & James";var s=[];var l,d,h,p;var u=0;var m=0;var v=0;var c=0;var f=window.innerWidth/2;var w=window.innerHeight/2;g();z();function M(t,n,a){var o=t*n;var r=new Uint8Array(4*o);var i=Math.floor(a.r*255);var s=Math.floor(a.g*255);var l=Math.floor(a.b*255);for(var d=0;d<o;d++){r[d*4]=i;r[d*4+1]=s;r[d*4+2]=l;r[d*4+3]=255}var h=new e.DataTexture(r,t,n,e.RGBAFormat);h.needsUpdate=true;return h}function g(){o=document.createElement("div");document.body.appendChild(o);r=document.createElement("div");r.style.fontFamily="Bungee,sans-serif";r.style.fontWeight=400;r.style.color="#ffffff";r.style.outlineColor="#000000";r.style.position="absolute";r.style.bottom="3em";r.style.width="100%";r.style.textAlign="center";var u=i.length;for(var m=0;m<u;m++){s.push("hsl("+360*m/u+",40%,50%")}for(var m=0;m<u;m++){var v=document.createElement("span");v.style.color=s[m];v.innerHTML=i[m];r.appendChild(v)}o.appendChild(r);d=new e.Scene;d.fog=new e.Fog(13426943,500,1e4);l=new e.PerspectiveCamera(50,window.innerWidth/window.innerHeight,1,1e4);l.position.set(0,100,500);d.add(l);p=new e.Object3D;d.add(p);var c=new e.TextureLoader;var f=c.load("img/texture.jpg");f.repeat.set(1,1);f.wrapS=f.wrapT=e.RepeatWrapping;f.anisotropy=16;var w=50;var g=3355443;var E=1;var L=[];L.push(new e.MeshPhongMaterial({map:f,bumpMap:f,bumpScale:E,color:16711680,specular:g,shininess:w}));L.push(new e.MeshPhongMaterial({map:f,color:1338170,specular:g,shininess:w}));L.push(new e.MeshPhongMaterial({map:f,color:5783552}));L.push(new e.MeshPhongMaterial({map:f,color:16766720}));L.push(new e.MeshPhongMaterial({map:f,bumpMap:f,bumpScale:E,color:13893672,specular:g,shininess:w}));L.push(new e.MeshPhongMaterial({map:f,bumpMap:f,bumpScale:E,color:15353392,specular:g,shininess:w}));L.push(new e.MeshPhongMaterial({map:f,bumpMap:f,bumpScale:E,color:2789309,specular:g,shininess:w}));L.push(new e.MeshPhongMaterial({map:f,bumpMap:f,bumpScale:E,color:12779554,specular:g,shininess:w}));var S=new e.Mesh(new e.CylinderGeometry(2,20,300,30,1,false),L[2]);p.add(S);function z(t,n,a,o,r,i,s){var l=[],d;for(var h=0;h<t*2;h++){if(h%2==1){d=t*2}else{d=t*4}var u=h/t*Math.PI;l.push(new e.Vector2(Math.cos(u)*d,Math.sin(u)*d));if(s&&h%2==0&&Math.random()>.6){var m=new e.SphereGeometry(8);var v=new e.Mesh(m,L[Math.floor(Math.random()*4)+4]);v.position.set(Math.cos(u)*d*1.25*.95,a-5,Math.sin(u)*d*1.25);p.add(v)}}var c=new e.Shape(l);var f=new e.ExtrudeGeometry(c,r);var w=new e.Mesh(f,i);w.position.set(n,a,o);if(s){w.rotation.set(Math.PI/2,0,0)}else{w.rotation.set(0,0,Math.PI/2)}p.add(w)}var C={depth:12,bevelEnabled:true,bevelSegments:10,steps:2};var A=20;for(var W=0;W<A;W++){z(A+3-W,0,-125+W*20,0,C,L[1],true)}var B={depth:6,bevelEnabled:false};z(7,0,280,-2,B,L[3],false);var G=new e.Color(9208183);var D=M(1,1,G);var H=new e.MeshPhongMaterial({color:16777215,specular:1118481,map:D});var D=c.load("img/ground.jpg",undefined,function(){H.map=D});D.wrapS=D.wrapT=e.RepeatWrapping;D.repeat.set(25,25);D.anisotropy=16;var T=new e.Mesh(new e.PlaneGeometry(2e4,2e4),H);T.position.y=-150;T.rotation.x=-Math.PI/2;p.add(T);var j=[];var F=c.load("img/snowflake.png");var I=[];var R=Math.floor(Math.random()*2e3)+2e3;for(var m=0;m<R;m++){I.push(Math.random()*2e3-1e3);I.push(Math.random()*2e3-1e3);I.push(Math.random()*2e3-1e3)}var k=new e.BufferGeometry;k.setAttribute("position",new e.BufferAttribute(new Float32Array(I),3));var X=[[[1,.2,.9],F,10],[[.9,.1,.5],F,8],[[.8,.05,.5],F,5]];for(var m=0;m<X.length;m++){var O=X[m][0];var U=X[m][1];var q=X[m][2];j[m]=new e.PointsMaterial({size:q,map:U,blending:e.AdditiveBlending,depthTest:false,transparent:true});j[m].color.setHSL(O[0],O[1],O[2]);var J=new e.Points(k,j[m]);J.rotation.x=Math.random()*10;J.rotation.y=Math.random()*10;J.rotation.z=Math.random()*10;p.add(J)}var V=new t;var _=V.load("fonts/helvetiker_bold.typeface.json");var K=new n("Merry Christmas",{font:_,size:100,height:40,curveSegments:4,bevelEnabled:true,bevelThickness:2,bevelSize:1.5,bevelOffset:0,bevelSegments:5});K.computeBoundingBox();var N=new e.Mesh(K,L);N.position.y=400;d.add(new e.AmbientLight(10066329));a=new e.Mesh(new e.SphereGeometry(5,10,10),new e.MeshBasicMaterial({color:16777215}));a.position.y=400;p.add(a);var Q=new e.PointLight(16777215,1,1e3);p.add(Q);Q.position.copy(a.position);var Y=new e.DirectionalLight(16776960,2);Y.position.set(10,1,1).normalize();p.add(Y);h=new e.WebGLRenderer({antialias:true,alpha:false});h.setClearColor(d.fog.color);h.setSize(window.innerWidth,window.innerHeight);o.appendChild(h.domElement);h.gammaInput=true;h.gammaOutput=true;h.physicallyBasedShading=true;document.addEventListener("mousedown",b,false);document.addEventListener("touchstart",P,false);document.addEventListener("touchmove",x,false);window.addEventListener("resize",y,false)}function y(){f=window.innerWidth/2;w=window.innerHeight/2;l.aspect=window.innerWidth/window.innerHeight;l.updateProjectionMatrix();h.setSize(window.innerWidth-20,window.innerHeight-20)}function b(e){e.preventDefault();document.addEventListener("mousemove",E,false);document.addEventListener("mouseup",L,false);document.addEventListener("mouseout",S,false);c=e.clientX-f;m=u}function E(e){v=e.clientX-f;u=m+(v-c)*.02}function L(e){document.removeEventListener("mousemove",E,false);document.removeEventListener("mouseup",L,false);document.removeEventListener("mouseout",S,false)}function S(e){document.removeEventListener("mousemove",E,false);document.removeEventListener("mouseup",L,false);document.removeEventListener("mouseout",S,false)}function P(e){if(e.touches.length==1){e.preventDefault();c=e.touches[0].pageX-f;m=u}}function x(e){if(e.touches.length==1){e.preventDefault();v=e.touches[0].pageX-f;u=m+(v-c)*.02}}function z(){requestAnimationFrame(z);C()}function C(){var e=Date.now()*25e-5;var t=r.children.length;var n=Math.floor(Date.now()/200)%t;for(var o=0;o<t;o++){r.children[o].style.color=s[(o+n)%t];if(o==n||o==n-t/2){r.children[o].style.fontSize="32pt"}else{r.children[o].style.fontSize="28pt"}}p.rotation.y+=(u-p.rotation.y)*.01;a.position.x=Math.cos(e)*300+d.position.x;a.position.z=Math.sin(e)*300+d.position.z;l.position.x=Math.cos(e)*800+d.position.x;l.position.z=Math.sin(e)*800+d.position.z;l.lookAt(d.position);h.render(d,l)}